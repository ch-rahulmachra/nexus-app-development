server {
  listen 80;

  # React SPA routing
  location / {
    root /usr/share/nginx/html;
    index index.html;
    try_files $uri /index.html;
  }

  # Auth Service
  location /api/auth/ {
    rewrite ^/api/auth/(.*)$ /auth/$1 break;
    proxy_pass http://auth-service:4000;
  }

  # User Service
  location /api/users/ {
    rewrite ^/api/users/(.*)$ /users/$1 break;
    proxy_pass http://user-service:5000;
  }

  # Project Service
  location /api/projects/ {
    rewrite ^/api/projects/(.*)$ /projects/$1 break;
    proxy_pass http://project-service:7000;
  }

  # Task Service
  location /api/tasks/ {
    rewrite ^/api/tasks/(.*)$ /tasks/$1 break;
    proxy_pass http://task-service:7100;
  }

  # Expense Service
  location /api/expenses/ {
    rewrite ^/api/expenses/(.*)$ /expenses/$1 break;
    proxy_pass http://expense-service:7200;
  }

  # Approval Service
  location /api/approvals/ {
    rewrite ^/api/approvals/(.*)$ /approvals/$1 break;
    proxy_pass http://approval-service:7300;
  }

  # Notification Service
  # location /api/notifications/ {
  #   proxy_pass http://notification-service:7400;
  # }
  location /api/notifications/ {
    rewrite ^/api/notifications/(.*)$ /$1 break;
    proxy_pass http://notification-service:7400;
  }

  location /api/audit/ {
    rewrite ^/api/audit/(.*)$ /$1 break;
    proxy_pass http://audit-service:7500;
  }

  # location /api/reports/ {
  #   rewrite ^/api/reports/(.*)$ /$1 break;
  #   proxy_pass http://reporting-service:7600;
  # }
  # Audit Service
  # location /api/audit/ {
  #   rewrite ^/api/audit/(.*)$ /audit/$1 break;
  #   proxy_pass http://audit-service:7500;
  # }

  # Reporting Service
  location /api/reports/ {
    rewrite ^/api/reports/?(.*)$ /reports/$1 break;
    proxy_pass http://reporting-service:7600;
  }
}